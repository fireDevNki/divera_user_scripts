{"type":1,"name":"Smart Home Auslösung","description":"Dieses Script bietet die Möglichkeit Webhooks einzelner Kameraden im Einsatzfall aufzurufen. \nHierfür wird im Alarm geprüft ob der entsprechende Nutzer adressiert ist. Nur bei enthaltenen Nutzer wird der Webhook aufgerufen.\nZur Konfiguration eines Nutzers werden die individuell UserId und der Webhook benötigt.\nBeim Aufruf des Webhooks werden keine Einsatzdaten übertragen. Dies gilt rein zur Information, das ein neuer Alarm anliegt.","configuration":[{"type":"text","key":"userId","label":"Primärschlüssel des Nutzers (Verwaltung/Benutzer/<Benutzer>/Extras)"},{"type":"text","key":"userUrl","label":"Ziel Url die im Einsatzfall aufgerufen werden soll."}],"supportedEvents":["alarm:notify"],"script_content":"local fetch = require(\"fetch\")\nlocal json = require(\"json\")\n\nfor _, item in ipairs(event.payload.user_cluster_relation) do\n    if item.id == tonumber(configuration.userId) then\n        fetch.post(configuration.userUrl, {\n            contentType = \"application/json\",\n            data = json.encode('Alarm')\n        })\n    end\nend"}