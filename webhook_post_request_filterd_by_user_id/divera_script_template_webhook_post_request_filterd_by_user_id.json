{"type":1,"name":"Smart Home Auslösung","description":"Dieses Script bietet die Möglichkeit Webhooks, als POST-REQUEST, einzelner Kameraden im Einsatzfall aufzurufen. \nHierfür wird im Alarm geprüft ob der entsprechende Nutzer adressiert ist. Nur bei enthaltenen Nutzer wird der Webhook aufgerufen.\nZur Konfiguration eines Nutzers werden die individuell UserId und der Webhook benötigt.\nBeim Aufruf des Webhooks werden keine detailierten Einsatzdaten übertragen. Nur das Stichwort des Alarms wird als Payload übertragen.","configuration":[{"type":"text","key":"userId","label":"Primärschlüssel des Nutzers (Verwaltung/Benutzer/<Benutzer>/Extras)"},{"type":"text","key":"userUrl","label":"Ziel Url die im Einsatzfall aufgerufen werden soll."}],"supportedEvents":["alarm:notify"],"script_content":"local fetch = require(\"fetch\")\nlocal json = require(\"json\")\nlocal alarm_title_only_as_payload = {\n  title = event.payload.title\n}\n\nfor _, item in ipairs(event.payload.user_cluster_relation) do\n    if item.id == tonumber(configuration.userId) then\n        fetch.post(configuration.userUrl, {\n            contentType = \"application/json\",\n            data = json.encode(alarm_title_only_as_payload)\n        })\n    end\nend"}